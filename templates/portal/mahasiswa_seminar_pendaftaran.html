<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <title>Pendaftaran Seminar Hasil PKL</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link
        rel="stylesheet"
        href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
    >
</head>
<body>
<div class="container my-4">

    <h2 class="mb-3">Pendaftaran Seminar Hasil PKL</h2>

    <div class="mb-3">
        <a href="{% url 'portal:mahasiswa_dashboard' %}"
            class="btn btn-outline-secondary btn-sm me-2">
            &larr; Kembali ke Dashboard
        </a>
        <p class="mb-1">
            Mahasiswa: <strong>{{ mahasiswa.nama }} ({{ mahasiswa.nim }})</strong>
        </p>
        <p class="mb-1">
            Dosen Pembimbing: 
            <strong>
                {{ mahasiswa.dosen_pembimbing.nama|default:"Belum ditetapkan" }}
            </strong>
        </p>
        <p class="mb-0">
            Jumlah bimbingan selesai: 
            <strong>{{ jumlah_bimbingan_selesai }}</strong> 
            (minimal 6x untuk bisa daftar seminar)
        </p>
    </div>

    {% if not eligible %}
        <div class="alert alert-warning">
            Anda <strong>belum memenuhi syarat</strong> untuk mendaftar seminar hasil PKL.
            Pastikan:
            <ul class="mb-0">
                <li>Sudah memiliki minimal 6 sesi bimbingan dengan status <em>Selesai (DONE)</em>.</li>
                <li>Dosen pembimbing PKL sudah ditetapkan.</li>
                <li>Periode PKL sudah diisi.</li>
            </ul>
        </div>
    {% endif %}

    {% if seminar %}
        <div class="alert alert-info">
            Status pendaftaran seminar Anda: 
            <strong>{{ seminar.get_status_display }}</strong>
            {% if seminar.jadwal %}
                <br>
                Jadwal seminar: <strong>{{ seminar.jadwal }}</strong>
            {% endif %}
            {% if seminar.dosen_penguji %}
                <br>
                Dosen penguji:
                <strong>{{ seminar.dosen_penguji.nama|default:"-" }}</strong>
            {% endif %}
        </div>
    {% endif %}

    <form method="post" enctype="multipart/form-data" class="mt-3">
        {% csrf_token %}

        {% if is_locked %}
            <fieldset disabled>
                <div class="mb-3">
                    <label class="form-label">Judul Laporan PKL</label>
                    {{ form.judul_laporan }}
                </div>
                <div class="mb-3">
                    <label class="form-label">File Laporan PKL (PDF)</label>
                    {{ form.file_laporan }}
                </div>
            </fieldset>
            <p class="text-muted">
                Pendaftaran sudah diproses sehingga tidak dapat diubah.
                Silakan hubungi koordinator PKL jika ada kesalahan.
            </p>
        {% else %}
            <div class="mb-3">
                <label class="form-label">Judul Laporan PKL</label>
                {{ form.judul_laporan }}
            </div>
            <div class="mb-3">
                <label class="form-label">File Laporan PKL (PDF)</label>
                {{ form.file_laporan }}
            </div>

            <div class="mb-3">
                <label class="form-label">Dosen Pembimbing PKL</label>
                <input
                    type="text"
                    class="form-control"
                    value="{{ mahasiswa.dosen_pembimbing.nama|default:'Belum ditetapkan' }}"
                    disabled
                >
            </div>

            <button
                type="submit"
                class="btn btn-primary"
                {% if not eligible %}disabled{% endif %}
            >
                Kirim Pendaftaran Seminar
            </button>
        {% endif %}
    </form>

</div>
</body>
</html>
